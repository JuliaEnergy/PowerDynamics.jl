<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>IEEE39 Part I: Modeling Â· PowerDynamics.jl</title><meta name="title" content="IEEE39 Part I: Modeling Â· PowerDynamics.jl"/><meta property="og:title" content="IEEE39 Part I: Modeling Â· PowerDynamics.jl"/><meta property="twitter:title" content="IEEE39 Part I: Modeling Â· PowerDynamics.jl"/><meta name="description" content="Documentation for PowerDynamics.jl."/><meta property="og:description" content="Documentation for PowerDynamics.jl."/><meta property="twitter:description" content="Documentation for PowerDynamics.jl."/><meta property="og:url" content="https://juliaenergy.github.io/PowerDynamics.jl/generated/ieee39_part1/"/><meta property="twitter:url" content="https://juliaenergy.github.io/PowerDynamics.jl/generated/ieee39_part1/"/><link rel="canonical" href="https://juliaenergy.github.io/PowerDynamics.jl/generated/ieee39_part1/"/><meta property="og:image" content="https://juliaenergy.github.io/PowerDynamics.jl/assets/preview.png"/><meta property="twitter:image" content="https://juliaenergy.github.io/PowerDynamics.jl/assets/preview.png"/><meta property="twitter:card" content="summary_large_image"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="PowerDynamics.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="PowerDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PowerDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../ModelingConcepts/">Modeling Concepts</a></li><li><a class="tocitem" href="../../initialization/">Initialization</a></li><li><a class="tocitem" href="../../Library/">Component Library</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../typical_simulation_workflow/">Typical Simulation Workflow</a></li><li><a class="tocitem" href="../custom_bus/">Custom Generator Bus</a></li><li><a class="tocitem" href="../custom_line/">Custom Transmission Line</a></li></ul></li><li><span class="tocitem">Advanced Examples</span><ul><li><a class="tocitem" href="../ieee9bus/">IEEE 9-Bus Example</a></li><li class="is-active"><a class="tocitem" href>IEEE39 Part I: Modeling</a><ul class="internal"><li><a class="tocitem" href="#System-Structure"><span>System Structure</span></a></li><li><a class="tocitem" href="#Setup-and-Data-Loading"><span>Setup and Data Loading</span></a></li><li><a class="tocitem" href="#Subcomponent-Definition"><span>Subcomponent Definition</span></a></li><li><a class="tocitem" href="#Bus-Template-Creation"><span>Bus Template Creation</span></a></li><li><a class="tocitem" href="#Bus-Instantiation-and-Parameter-Setting"><span>Bus Instantiation and Parameter Setting</span></a></li><li><a class="tocitem" href="#Transmission-Line-Creation"><span>Transmission Line Creation</span></a></li><li><a class="tocitem" href="#Network-Assembly"><span>Network Assembly</span></a></li></ul></li><li><a class="tocitem" href="../ieee39_part2/">IEEE39 Part II: Initialization</a></li><li><a class="tocitem" href="../ieee39_part3/">IEEE39 Part III: Simulation</a></li><li><a class="tocitem" href="../ieee39_part4/">IEEE39 Part IV: Parameter Tuning</a></li><li><a class="tocitem" href="../emt_toymodel/">EMT Toymodel</a></li></ul></li><li><a class="tocitem" href="../../API/">API</a></li><li><a class="tocitem" href="../../networkdynamics_forward/">ğŸ”— NetworkDynamics.jl Docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Advanced Examples</a></li><li class="is-active"><a href>IEEE39 Part I: Modeling</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>IEEE39 Part I: Modeling</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaEnergy/PowerDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaEnergy/PowerDynamics.jl/blob/main/docs/examples/ieee39_part1.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ieee39-part1"><a class="docs-heading-anchor" href="#ieee39-part1">IEEE39 Bus Tutorial - Part I: Model Creation</a><a id="ieee39-part1-1"></a><a class="docs-heading-anchor-permalink" href="#ieee39-part1" title="Permalink"></a></h1><p>This is the first part of a four-part tutorial series for the IEEE 39-bus test system:</p><ul><li><strong>Part I: Model Creation</strong> (this tutorial) - Build the network structure with buses, lines, and components</li><li><strong>Part II: Initialization</strong> - Perform power flow calculations and dynamic initialization</li><li><strong>Part III: Dynamic Simulation</strong> - Run time-domain simulations and analyze system behavior</li><li><strong>Part IV: Advanced Modeling &amp; Parameter Optimization</strong> - Create custom components and optimize system parameters</li></ul><p>In this first part, we&#39;ll construct the complete IEEE 39-bus network model using PowerDynamics.jl, including generators, loads, transmission lines, and control systems.</p><p>This script can be downloaded as a normal Julia script <a href="../ieee39_part1.jl">here</a>.</p><h2 id="System-Structure"><a class="docs-heading-anchor" href="#System-Structure">System Structure</a><a id="System-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#System-Structure" title="Permalink"></a></h2><p>The system consists of 39 buses (with 10 generators and 19 loads) and 46 branches (12 of which are transformers).</p><p>The buses fall into the following categories:</p><ul><li>Junction: pure transient buses without dynamic components</li><li>Load: buses with loads only</li><li>Controlled Machine: buses with controlled machines (generators with AVR and GOV)</li><li>Controlled Machine + Load: buses with controlled machines and loads</li><li>Uncontrolled Machine + Load: buses with uncontrolled machines and loads</li></ul><p>For the power flow solution, we have a slack bus, PV buses and PQ buses.</p><p>For the dynamic simulation, we will use the following models:</p><ul><li>ZIP Load for loads,</li><li>6th Order Sauer-Pai Machine and</li><li>AVR Type I and TGOV1 for controlled machines.</li></ul><h2 id="Setup-and-Data-Loading"><a class="docs-heading-anchor" href="#Setup-and-Data-Loading">Setup and Data Loading</a><a id="Setup-and-Data-Loading-1"></a><a class="docs-heading-anchor-permalink" href="#Setup-and-Data-Loading" title="Permalink"></a></h2><div class="admonition is-warning" id="No-Standardized-Data-Import-e110cedfb7d53bf4"><header class="admonition-header">No Standardized Data Import<a class="admonition-anchor" href="#No-Standardized-Data-Import-e110cedfb7d53bf4" title="Permalink"></a></header><div class="admonition-body"><p>As of now, PowerDynamics.jl does not support any advanced import mechanisms for power grids. Therefore, this tutorial loads the data from some custom CSV files.</p></div></div><p>First, we&#39;ll load the required packages and read the system data from CSV files. The IEEE 39-bus system data is organized into separate files for different components.</p><pre><code class="language-julia hljs">using PowerDynamics
using PowerDynamics.Library
using ModelingToolkit
using NetworkDynamics
using DataFrames
using CSV

DATA_DIR = joinpath(pkgdir(PowerDynamics), &quot;docs&quot;, &quot;examples&quot;, &quot;ieee39data&quot;)</code></pre><p>The system data is stored in CSV files containing:</p><details class="admonition is-details" id="bus.csv-Bus-Configuration-Data-7219a978b5da0f69"><summary class="admonition-header">bus.csv - Bus Configuration Data<a class="admonition-anchor" href="#bus.csv-Bus-Configuration-Data-7219a978b5da0f69" title="Permalink"></a></summary><div class="admonition-body"><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>bus</code></td><td style="text-align: left">Bus number (unique identifier)</td></tr><tr><td style="text-align: left"><code>bus_type</code></td><td style="text-align: left">Power flow bus type: &quot;PQ&quot; (load), &quot;PV&quot; (generator), &quot;Slack&quot; (reference)</td></tr><tr><td style="text-align: left"><code>category</code></td><td style="text-align: left">Component category: &quot;junction&quot;, &quot;load&quot;, &quot;ctrld_machine&quot;, &quot;ctrld_machine_load&quot;, &quot;unctrld_machine_load&quot;</td></tr><tr><td style="text-align: left"><code>P</code></td><td style="text-align: left">Active power injection [pu] (positive = generation, negative = load)</td></tr><tr><td style="text-align: left"><code>Q</code></td><td style="text-align: left">Reactive power injection [pu] (positive = generation, negative = load)</td></tr><tr><td style="text-align: left"><code>V</code></td><td style="text-align: left">Voltage magnitude [pu] (for PV and Slack buses)</td></tr><tr><td style="text-align: left"><code>base_kv</code></td><td style="text-align: left">Base voltage level [kV]</td></tr><tr><td style="text-align: left"><code>has_load</code></td><td style="text-align: left">Boolean flag indicating presence of load component</td></tr><tr><td style="text-align: left"><code>has_gen</code></td><td style="text-align: left">Boolean flag indicating presence of generator component</td></tr><tr><td style="text-align: left"><code>has_avr</code></td><td style="text-align: left">Boolean flag indicating presence of automatic voltage regulator</td></tr><tr><td style="text-align: left"><code>has_gov</code></td><td style="text-align: left">Boolean flag indicating presence of turbine governor</td></tr></table></div></details><details class="admonition is-details" id="branch.csv-Transmission-Line-and-Transformer-Data-6b828242552737b1"><summary class="admonition-header">branch.csv - Transmission Line and Transformer Data<a class="admonition-anchor" href="#branch.csv-Transmission-Line-and-Transformer-Data-6b828242552737b1" title="Permalink"></a></summary><div class="admonition-body"><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>src_bus</code></td><td style="text-align: left">Source bus number</td></tr><tr><td style="text-align: left"><code>dst_bus</code></td><td style="text-align: left">Destination bus number</td></tr><tr><td style="text-align: left"><code>transformer</code></td><td style="text-align: left">Transformer flag (0 = line, 1 = transformer)</td></tr><tr><td style="text-align: left"><code>r_src</code></td><td style="text-align: left">Source end transformation ratio [pu]</td></tr><tr><td style="text-align: left"><code>R</code></td><td style="text-align: left">Series resistance [pu]</td></tr><tr><td style="text-align: left"><code>X</code></td><td style="text-align: left">Series reactance [pu]</td></tr><tr><td style="text-align: left"><code>G_src</code></td><td style="text-align: left">Source end shunt conductance [pu]</td></tr><tr><td style="text-align: left"><code>G_dst</code></td><td style="text-align: left">Destination end shunt conductance [pu]</td></tr><tr><td style="text-align: left"><code>B_src</code></td><td style="text-align: left">Source end shunt susceptance [pu]</td></tr><tr><td style="text-align: left"><code>B_dst</code></td><td style="text-align: left">Destination end shunt susceptance [pu]</td></tr></table></div></details><details class="admonition is-details" id="load.csv-ZIP-Load-Model-Parameters-51cb6b1f296548bb"><summary class="admonition-header">load.csv - ZIP Load Model Parameters<a class="admonition-anchor" href="#load.csv-ZIP-Load-Model-Parameters-51cb6b1f296548bb" title="Permalink"></a></summary><div class="admonition-body"><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>bus</code></td><td style="text-align: left">Bus number where load is connected</td></tr><tr><td style="text-align: left"><code>Pset</code></td><td style="text-align: left">Active power at operation point [pu]</td></tr><tr><td style="text-align: left"><code>Qset</code></td><td style="text-align: left">Reactive power at operation point [pu]</td></tr><tr><td style="text-align: left"><code>KpZ</code></td><td style="text-align: left">Active power constant impedance fraction</td></tr><tr><td style="text-align: left"><code>KqZ</code></td><td style="text-align: left">Reactive power constant impedance fraction</td></tr><tr><td style="text-align: left"><code>KpI</code></td><td style="text-align: left">Active power constant current fraction</td></tr><tr><td style="text-align: left"><code>KqI</code></td><td style="text-align: left">Reactive power constant current fraction</td></tr><tr><td style="text-align: left"><code>KpC</code></td><td style="text-align: left">Active power constant power fraction (1-KpZ-KpI)</td></tr><tr><td style="text-align: left"><code>KqC</code></td><td style="text-align: left">Reactive power constant power fraction (1-KqZ-KqI)</td></tr></table><p>Note: ZIP loads combine constant impedance (Z), constant current (I), and constant power (P) components.</p></div></details><details class="admonition is-details" id="machine.csv-Generator-(Sauer-Pai-Machine)-Parameters-75e347db7375a78a"><summary class="admonition-header">machine.csv - Generator (Sauer-Pai Machine) Parameters<a class="admonition-anchor" href="#machine.csv-Generator-(Sauer-Pai-Machine)-Parameters-75e347db7375a78a" title="Permalink"></a></summary><div class="admonition-body"><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>bus</code></td><td style="text-align: left">Bus number where generator is connected</td></tr><tr><td style="text-align: left"><code>Sn</code></td><td style="text-align: left">Machine power rating [MVA]</td></tr><tr><td style="text-align: left"><code>V_b</code></td><td style="text-align: left">System voltage basis [kV]</td></tr><tr><td style="text-align: left"><code>Vn</code></td><td style="text-align: left">Machine voltage rating [kV]</td></tr><tr><td style="text-align: left"><code>R_s</code></td><td style="text-align: left">Stator resistance [pu]</td></tr><tr><td style="text-align: left"><code>X_ls</code></td><td style="text-align: left">Stator leakage reactance [pu]</td></tr><tr><td style="text-align: left"><code>X_d</code></td><td style="text-align: left">d-axis synchronous reactance [pu]</td></tr><tr><td style="text-align: left"><code>X_q</code></td><td style="text-align: left">q-axis synchronous reactance [pu]</td></tr><tr><td style="text-align: left"><code>Xâ€²_d</code></td><td style="text-align: left">d-axis transient reactance [pu]</td></tr><tr><td style="text-align: left"><code>Xâ€²_q</code></td><td style="text-align: left">q-axis transient reactance [pu]</td></tr><tr><td style="text-align: left"><code>Xâ€³_d</code></td><td style="text-align: left">d-axis subtransient reactance [pu]</td></tr><tr><td style="text-align: left"><code>Xâ€³_q</code></td><td style="text-align: left">q-axis subtransient reactance [pu]</td></tr><tr><td style="text-align: left"><code>Tâ€²_d0</code></td><td style="text-align: left">d-axis transient time constant [s]</td></tr><tr><td style="text-align: left"><code>Tâ€²_q0</code></td><td style="text-align: left">q-axis transient time constant [s]</td></tr><tr><td style="text-align: left"><code>Tâ€³_d0</code></td><td style="text-align: left">d-axis subtransient time constant [s]</td></tr><tr><td style="text-align: left"><code>Tâ€³_q0</code></td><td style="text-align: left">q-axis subtransient time constant [s]</td></tr><tr><td style="text-align: left"><code>H</code></td><td style="text-align: left">Inertia constant [s]</td></tr><tr><td style="text-align: left"><code>D</code></td><td style="text-align: left">Direct shaft damping coefficient</td></tr></table></div></details><details class="admonition is-details" id="avr.csv-Automatic-Voltage-Regulator-(AVR-Type-I)-Parameters-109568fd8cbe45a7"><summary class="admonition-header">avr.csv - Automatic Voltage Regulator (AVR Type I) Parameters<a class="admonition-anchor" href="#avr.csv-Automatic-Voltage-Regulator-(AVR-Type-I)-Parameters-109568fd8cbe45a7" title="Permalink"></a></summary><div class="admonition-body"><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>bus</code></td><td style="text-align: left">Bus number where AVR-controlled generator is located</td></tr><tr><td style="text-align: left"><code>Ka</code></td><td style="text-align: left">Amplifier gain</td></tr><tr><td style="text-align: left"><code>Ke</code></td><td style="text-align: left">Field circuit integral deviation</td></tr><tr><td style="text-align: left"><code>Kf</code></td><td style="text-align: left">Stabilizer gain</td></tr><tr><td style="text-align: left"><code>Ta</code></td><td style="text-align: left">Amplifier time constant [s]</td></tr><tr><td style="text-align: left"><code>Tf</code></td><td style="text-align: left">Stabilizer time constant [s]</td></tr><tr><td style="text-align: left"><code>Te</code></td><td style="text-align: left">Field circuit time constant [s]</td></tr><tr><td style="text-align: left"><code>Tr</code></td><td style="text-align: left">Measurement time constant [s]</td></tr><tr><td style="text-align: left"><code>vr_min</code></td><td style="text-align: left">Minimum regulator voltage [pu]</td></tr><tr><td style="text-align: left"><code>vr_max</code></td><td style="text-align: left">Maximum regulator voltage [pu]</td></tr><tr><td style="text-align: left"><code>E1</code></td><td style="text-align: left">First ceiling voltage [pu]</td></tr><tr><td style="text-align: left"><code>Se1</code></td><td style="text-align: left">First ceiling saturation factor</td></tr><tr><td style="text-align: left"><code>E2</code></td><td style="text-align: left">Second ceiling voltage [pu]</td></tr><tr><td style="text-align: left"><code>Se2</code></td><td style="text-align: left">Second ceiling saturation factor</td></tr></table></div></details><details class="admonition is-details" id="gov.csv-Turbine-Governor-(TGOV1)-Parameters-216da524adc1dcee"><summary class="admonition-header">gov.csv - Turbine Governor (TGOV1) Parameters<a class="admonition-anchor" href="#gov.csv-Turbine-Governor-(TGOV1)-Parameters-216da524adc1dcee" title="Permalink"></a></summary><div class="admonition-body"><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>bus</code></td><td style="text-align: left">Bus number where governor-controlled generator is located</td></tr><tr><td style="text-align: left"><code>V_min</code></td><td style="text-align: left">Minimum valve position [pu]</td></tr><tr><td style="text-align: left"><code>V_max</code></td><td style="text-align: left">Maximum valve position [pu]</td></tr><tr><td style="text-align: left"><code>R</code></td><td style="text-align: left">Governor droop [Machine PU]</td></tr><tr><td style="text-align: left"><code>T1</code></td><td style="text-align: left">First transient time constant [s]</td></tr><tr><td style="text-align: left"><code>T2</code></td><td style="text-align: left">Second transient time constant [s]</td></tr><tr><td style="text-align: left"><code>T3</code></td><td style="text-align: left">Third transient time constant [s]</td></tr><tr><td style="text-align: left"><code>DT</code></td><td style="text-align: left">Turbine damping coefficient</td></tr><tr><td style="text-align: left"><code>Ï‰_ref</code></td><td style="text-align: left">Reference frequency [pu]</td></tr></table></div></details><pre><code class="language-julia hljs">branch_df = CSV.read(joinpath(DATA_DIR, &quot;branch.csv&quot;), DataFrame)
bus_df = CSV.read(joinpath(DATA_DIR, &quot;bus.csv&quot;), DataFrame)
load_df = CSV.read(joinpath(DATA_DIR, &quot;load.csv&quot;), DataFrame)
machine_df = CSV.read(joinpath(DATA_DIR, &quot;machine.csv&quot;), DataFrame)
avr_df = CSV.read(joinpath(DATA_DIR, &quot;avr.csv&quot;), DataFrame)
gov_df = CSV.read(joinpath(DATA_DIR, &quot;gov.csv&quot;), DataFrame)</code></pre><p>System base values follow the IEEE 39-bus standard:</p><pre><code class="language-julia hljs">BASE_MVA = 100.0
BASE_FREQ = 60.0</code></pre><h2 id="Subcomponent-Definition"><a class="docs-heading-anchor" href="#Subcomponent-Definition">Subcomponent Definition</a><a id="Subcomponent-Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Subcomponent-Definition" title="Permalink"></a></h2><p>As stated above, our buses fall into 5 different categories. We will define a &quot;template&quot; for each of those categories and then create the individual buses from those templates. By doing so, we can reach substantial performance improvements, as we do not have to repeatedly <strong>compile</strong> the same models (the symbolic simplification is quite costly). Instead, we copy the templates and adjust parameters.</p><p>However, before we can define the bus templates, we need to define the individual subcomponents. Those subcomponents are MTK models and not yet compiled node models. See <a href="../../ModelingConcepts/#Modeling-Concepts">Modeling Concepts</a> and the <a href="../custom_bus/#custom-bus">custom bus tutorial</a>.</p><h3 id="Load-Model"><a class="docs-heading-anchor" href="#Load-Model">Load Model</a><a id="Load-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Model" title="Permalink"></a></h3><p>We use the ZIP load model to represent loads. This model satisfies the <a href="../../ModelingConcepts/#Injector-Interface">Injector Interface</a>.</p><pre><code class="nohighlight hljs">(t) â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 oâ”€â”€â”¤ ZIP Load â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><pre><code class="language-julia hljs">load = ZIPLoad(;name=:ZIPLoad)</code></pre><h3 id="Generator-Models"><a class="docs-heading-anchor" href="#Generator-Models">Generator Models</a><a id="Generator-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Generator-Models" title="Permalink"></a></h3><p>For generators, we use the Sauer-Pai machine model, which is a 6th-order synchronous machine model. We create two variants:</p><p><strong>Uncontrolled Machine</strong>: No external control inputs for mechanical torque or field voltage. This model satisfies the <a href="../../ModelingConcepts/#Injector-Interface">Injector Interface</a> directly.</p><pre><code class="nohighlight hljs">(t) â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 oâ”€â”€â”¤ Machine â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><pre><code class="language-julia hljs">uncontrolled_machine = SauerPaiMachine(;
    Ï„_m_input=false,  ## No external mechanical torque input
    vf_input=false,   ## No external field voltage input
    name=:machine,
)</code></pre><p><strong>Controlled Machine</strong>: Includes automatic voltage regulator (AVR) and turbine governor controls.</p><p>The controlled machine is modeled as a <strong>composite injector</strong>. It consists of 3 subcomponents: the machine, the AVR and the governor. The AVR receives the voltage magnitude measurement from the terminal of the machine and sets the field voltage. The governor receives the frequency measurement and sets the mechanical torque. Together, they satisfy the <a href="../../ModelingConcepts/#Injector-Interface">Injector Interface</a>.</p><pre><code class="nohighlight hljs">      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ CtrldMachine  u_mag_meas      â”‚
      â”‚              â•­â”€â”€â”€â”€â”€â†’â”€â”€â”€â”€â•®     â”‚
      â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”      â”Œâ”€â”´â”€â”€â”€â” â”‚
  (t) â”‚    â”‚           â”œâ”€â”€â”€â†â”€â”€â”¤ AVR â”‚ â”‚
   oâ”€â”€â”¼â”€â”€â”€â”€â”¤ Sauer-Pai â”‚ vf   â””â”€â”€â”€â”€â”€â”˜ â”‚
      â”‚    â”‚ Machine   â”‚ Ï„_m  â”Œâ”€â”€â”€â”€â”€â” â”‚
      â”‚    â”‚           â”œâ”€â”€â”€â†â”€â”€â”¤ Gov â”‚ â”‚
      â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜      â””â”€â”¬â”€â”€â”€â”˜ â”‚
      â”‚              â•°â”€â”€â”€â”€â”€â†’â”€â”€â”€â”€â•¯     â”‚
      â”‚                 Ï‰_meas        â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><pre><code class="language-julia hljs">_machine = SauerPaiMachine(;
    name=:machine,
)
_avr = AVRTypeI(;
    name=:avr,
    ceiling_function=:quadratic,
)
_gov = TGOV1(; name=:gov,)

controlled_machine = CompositeInjector(
    [_machine, _avr, _gov],
    name=:ctrld_gen
)</code></pre><h2 id="Bus-Template-Creation"><a class="docs-heading-anchor" href="#Bus-Template-Creation">Bus Template Creation</a><a id="Bus-Template-Creation-1"></a><a class="docs-heading-anchor-permalink" href="#Bus-Template-Creation" title="Permalink"></a></h2><p>Now we have all the components (i.e., the MTK models) so we can combine them into full bus models and compile the methods.</p><h3 id="Junction-Bus"><a class="docs-heading-anchor" href="#Junction-Bus">Junction Bus</a><a id="Junction-Bus-1"></a><a class="docs-heading-anchor-permalink" href="#Junction-Bus" title="Permalink"></a></h3><p>Pure transmission buses with no generation or load</p><pre><code class="nohighlight hljs">           â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
           â•‘ Junction (compiled)  â•‘
 Network   â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
interface  â•‘  â”‚MTKBus           â”‚ â•‘
 current â”€â”€â”€â”€â†’â”‚â”Œâ”€â”€â”€â”€â”€â”€â”         â”‚ â•‘
           â•‘  â”‚â”‚BusBarâ”‚(nothing)â”‚ â•‘
 voltage â†â”€â”€â”€â”€â”‚â””â”€â”€â”€â”€â”€â”€â”˜         â”‚ â•‘
           â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
           â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre><pre><code class="language-julia hljs">@named junction_bus_template = compile_bus(MTKBus())
strip_defaults!(junction_bus_template)  ## Clear default parameters for manual setting</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">VertexModel <span class="sgr1">:junction_bus_template</span> <span class="sgr94">PureStateMap()</span>
 â”œâ”€ 2 inputs:  [busbarâ‚Ši_r, busbarâ‚Ši_i]
 â”œâ”€ 2 states:  [busbarâ‚Šu_i, busbarâ‚Šu_r]
 |    with diagonal mass matrix [0, 0]
 â””â”€ 2 outputs: [busbarâ‚Šu_r, busbarâ‚Šu_i]</code></pre><h3 id="Load-Bus"><a class="docs-heading-anchor" href="#Load-Bus">Load Bus</a><a id="Load-Bus-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Bus" title="Permalink"></a></h3><p>Buses with only load components</p><pre><code class="nohighlight hljs">           â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
           â•‘ Load (compiled)     â•‘
 Network   â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
interface  â•‘  â”‚MTKBus          â”‚ â•‘
 current â”€â”€â”€â”€â†’â”‚â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”‚ â•‘
           â•‘  â”‚â”‚BusBarâ”œoâ”¤Loadâ”‚ â”‚ â•‘
 voltage â†â”€â”€â”€â”€â”‚â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â”‚ â•‘
           â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
           â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre><pre><code class="language-julia hljs">@named load_bus_template = compile_bus(MTKBus(load))
strip_defaults!(load_bus_template)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">VertexModel <span class="sgr1">:load_bus_template</span> <span class="sgr94">PureStateMap()</span>
 â”œâ”€ 2 inputs:  [busbarâ‚Ši_r, busbarâ‚Ši_i]
 â”œâ”€ 2 states:  [busbarâ‚Šu_r, busbarâ‚Šu_i]
 |    with diagonal mass matrix [0, 0]
 â”œâ”€ 2 outputs: [busbarâ‚Šu_r, busbarâ‚Šu_i]
 â””â”€ 9 params:  [ZIPLoadâ‚ŠPset, ZIPLoadâ‚ŠQset, ZIPLoadâ‚ŠVset<span class="sgr90">â‰ˆ1</span>, ZIPLoadâ‚ŠKpZ, ZIPLoadâ‚ŠKqZ, ZIPLoadâ‚ŠKpI, ZIPLoadâ‚ŠKqI, ZIPLoadâ‚ŠKpC, ZIPLoadâ‚ŠKqC]</code></pre><h3 id="Generator-Bus-(Controlled)"><a class="docs-heading-anchor" href="#Generator-Bus-(Controlled)">Generator Bus (Controlled)</a><a id="Generator-Bus-(Controlled)-1"></a><a class="docs-heading-anchor-permalink" href="#Generator-Bus-(Controlled)" title="Permalink"></a></h3><p>Buses with controlled generators (machine + AVR + governor)</p><pre><code class="nohighlight hljs">            â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
            â•‘ Ctrld Machine Bus (compiled)                   â•‘
            â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
            â•‘  â”‚MTKBus                                     â”‚ â•‘
            â•‘  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â•‘
  Network   â•‘  â”‚         â”‚CtrldMachine  â•­â”€â”€â”€â”€â”€â†’â”€â”€â”€â”€â•®     â”‚ â”‚ â•‘
 interface  â•‘  â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”      â”Œâ”€â”´â”€â”€â”€â” â”‚ â”‚ â•‘
  current â”€â”€â”€â”€â†’â”‚â”Œâ”€â”€â”€â”€â”€â”€â” â”‚    â”‚           â”œâ”€â”€â”€â†â”€â”€â”¤ AVR â”‚ â”‚ â”‚ â•‘
            â•‘  â”‚â”‚BusBarâ”œoâ”¼â”€â”€â”€â”€â”¤ Sauer-Pai â”‚      â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â•‘
  voltage â†â”€â”€â”€â”€â”‚â””â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ Machine   â”‚      â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ â•‘
            â•‘  â”‚         â”‚    â”‚           â”œâ”€â”€â”€â†â”€â”€â”¤ Gov â”‚ â”‚ â”‚ â•‘
            â•‘  â”‚         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜      â””â”€â”¬â”€â”€â”€â”˜ â”‚ â”‚ â•‘
            â•‘  â”‚         â”‚              â•°â”€â”€â”€â”€â”€â†’â”€â”€â”€â”€â•¯     â”‚ â”‚ â•‘
            â•‘  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â•‘
            â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
            â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre><pre><code class="language-julia hljs">@named ctrld_machine_bus_template = compile_bus(
    MTKBus(controlled_machine);
)
strip_defaults!(ctrld_machine_bus_template)
# Set system-wide base values for all generators
set_default!(ctrld_machine_bus_template, r&quot;S_b$&quot;, BASE_MVA)
set_default!(ctrld_machine_bus_template, r&quot;Ï‰_b$&quot;, 2Ï€*BASE_FREQ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">VertexModel <span class="sgr1">:ctrld_machine_bus_template</span> <span class="sgr94">PureStateMap()</span>
 â”œâ”€  2 inputs:  [busbarâ‚Ši_r, busbarâ‚Ši_i]
 â”œâ”€ 15 states:  [ctrld_genâ‚Šgovâ‚ŠÏ„_mâ‚Šu<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šgovâ‚Šxg1<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šgovâ‚Šxg2<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šavrâ‚Švfout<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šavrâ‚Šv_fb<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šavrâ‚Švr<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šavrâ‚Švm<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šmachineâ‚ŠÏˆâ€³_q<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šmachineâ‚ŠÏˆâ€³_d<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šmachineâ‚ŠEâ€²_d<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šmachineâ‚ŠEâ€²_q<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šmachineâ‚ŠÏ‰<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šmachineâ‚ŠÎ´<span class="sgr90">â‰ˆ0</span>, busbarâ‚Šu_r, busbarâ‚Šu_i]
 |     with diagonal mass matrix [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0]
 â”œâ”€  2 outputs: [busbarâ‚Šu_r, busbarâ‚Šu_i]
 â””â”€ 42 params:  [ctrld_genâ‚Šmachineâ‚ŠR_s, ctrld_genâ‚Šmachineâ‚ŠX_d, ctrld_genâ‚Šmachineâ‚ŠX_q, ctrld_genâ‚Šmachineâ‚ŠXâ€²_d, ctrld_genâ‚Šmachineâ‚ŠXâ€²_q, ctrld_genâ‚Šmachineâ‚ŠXâ€³_d, ctrld_genâ‚Šmachineâ‚ŠXâ€³_q, ctrld_genâ‚Šmachineâ‚ŠX_ls, ctrld_genâ‚Šmachineâ‚ŠTâ€²_d0, ctrld_genâ‚Šmachineâ‚ŠTâ€³_d0, ctrld_genâ‚Šmachineâ‚ŠTâ€²_q0, ctrld_genâ‚Šmachineâ‚ŠTâ€³_q0, ctrld_genâ‚Šmachineâ‚ŠH, ctrld_genâ‚Šmachineâ‚ŠD, ctrld_genâ‚Šmachineâ‚ŠS_b=100, ctrld_genâ‚Šmachineâ‚ŠV_b, ctrld_genâ‚Šmachineâ‚ŠÏ‰_b=376.99, ctrld_genâ‚Šmachineâ‚ŠSn, ctrld_genâ‚Šmachineâ‚ŠVn, ctrld_genâ‚Šavrâ‚ŠTr, ctrld_genâ‚Šavrâ‚Švref<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šavrâ‚ŠKa, ctrld_genâ‚Šavrâ‚ŠKe, ctrld_genâ‚Šavrâ‚ŠKf, ctrld_genâ‚Šavrâ‚ŠTa, ctrld_genâ‚Šavrâ‚ŠTf, ctrld_genâ‚Šavrâ‚ŠTe, ctrld_genâ‚Šavrâ‚Švr_min, ctrld_genâ‚Šavrâ‚Švr_max, ctrld_genâ‚Šavrâ‚ŠE1, ctrld_genâ‚Šavrâ‚ŠE2, ctrld_genâ‚Šavrâ‚ŠSe1, ctrld_genâ‚Šavrâ‚ŠSe2, ctrld_genâ‚Šgovâ‚ŠÏ‰_ref, ctrld_genâ‚Šgovâ‚Šp_ref<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šgovâ‚ŠV_min, ctrld_genâ‚Šgovâ‚ŠV_max, ctrld_genâ‚Šgovâ‚ŠR, ctrld_genâ‚Šgovâ‚ŠT1, ctrld_genâ‚Šgovâ‚ŠT2, ctrld_genâ‚Šgovâ‚ŠT3, ctrld_genâ‚Šgovâ‚ŠDT]</code></pre><h3 id="Generator-Load-Bus-(Controlled)"><a class="docs-heading-anchor" href="#Generator-Load-Bus-(Controlled)">Generator + Load Bus (Controlled)</a><a id="Generator-Load-Bus-(Controlled)-1"></a><a class="docs-heading-anchor-permalink" href="#Generator-Load-Bus-(Controlled)" title="Permalink"></a></h3><p>Buses with both controlled generators and loads</p><pre><code class="nohighlight hljs">            â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
            â•‘ Ctrld Machine Load Bus (compiled)               â•‘
            â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
            â•‘  â”‚MTKBus    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â•‘
            â•‘  â”‚          â”‚CtrldMachine  â•­â”€â”€â”€â”€â”€â†’â”€â”€â”€â”€â•®     â”‚ â”‚ â•‘
            â•‘  â”‚          â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”      â”Œâ”€â”´â”€â”€â”€â” â”‚ â”‚ â•‘
            â•‘  â”‚          â”‚    â”‚           â”œâ”€â”€â”€â†â”€â”€â”¤ AVR â”‚ â”‚ â”‚ â•‘
  Network   â•‘  â”‚        â”Œâ”€â”¼â”€â”€â”€â”€â”¤ Sauer-Pai â”‚      â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â•‘
 interface  â•‘  â”‚        â”‚ â”‚    â”‚ Machine   â”‚      â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ â•‘
  current â”€â”€â”€â”€â†’â”‚â”Œâ”€â”€â”€â”€â”€â”€â”â”‚ â”‚    â”‚           â”œâ”€â”€â”€â†â”€â”€â”¤ Gov â”‚ â”‚ â”‚ â•‘
            â•‘  â”‚â”‚BusBarâ”œo â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜      â””â”€â”¬â”€â”€â”€â”˜ â”‚ â”‚ â•‘
  voltage â†â”€â”€â”€â”€â”‚â””â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚              â•°â”€â”€â”€â”€â”€â†’â”€â”€â”€â”€â•¯     â”‚ â”‚ â•‘
            â•‘  â”‚        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â•‘
            â•‘  â”‚        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”                          â”‚ â•‘
            â•‘  â”‚        â””â”€â”¤ Load â”‚                          â”‚ â•‘
            â•‘  â”‚          â””â”€â”€â”€â”€â”€â”€â”˜                          â”‚ â•‘
            â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
            â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre><pre><code class="language-julia hljs">@named ctrld_machine_load_bus_template = compile_bus(
    MTKBus(controlled_machine, load);
)
strip_defaults!(ctrld_machine_load_bus_template)
set_default!(ctrld_machine_load_bus_template, r&quot;S_b$&quot;, BASE_MVA)
set_default!(ctrld_machine_load_bus_template, r&quot;Ï‰_b$&quot;, 2Ï€*BASE_FREQ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">VertexModel <span class="sgr1">:ctrld_machine_load_bus_template</span> <span class="sgr94">NoFeedForward()</span>
 â”œâ”€  2 inputs:  [busbarâ‚Ši_r, busbarâ‚Ši_i]
 â”œâ”€ 15 states:  [ctrld_genâ‚Šgovâ‚ŠÏ„_mâ‚Šu<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šmachineâ‚Šterminalâ‚Ši_r<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šmachineâ‚Šterminalâ‚Ši_i<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šgovâ‚Šxg1<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šgovâ‚Šxg2<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šavrâ‚Švfout<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šavrâ‚Šv_fb<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šavrâ‚Švr<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šavrâ‚Švm<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šmachineâ‚ŠÏˆâ€³_q<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šmachineâ‚ŠÏˆâ€³_d<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šmachineâ‚ŠEâ€²_d<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šmachineâ‚ŠEâ€²_q<span class="sgr90">â‰ˆ0</span>, ctrld_genâ‚Šmachineâ‚ŠÏ‰<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šmachineâ‚ŠÎ´<span class="sgr90">â‰ˆ0</span>]
 |     with diagonal mass matrix [0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
 â”œâ”€  2 outputs: [busbarâ‚Šu_r, busbarâ‚Šu_i]
 â””â”€ 51 params:  [ctrld_genâ‚Šmachineâ‚ŠR_s, ctrld_genâ‚Šmachineâ‚ŠX_d, ctrld_genâ‚Šmachineâ‚ŠX_q, ctrld_genâ‚Šmachineâ‚ŠXâ€²_d, ctrld_genâ‚Šmachineâ‚ŠXâ€²_q, ctrld_genâ‚Šmachineâ‚ŠXâ€³_d, ctrld_genâ‚Šmachineâ‚ŠXâ€³_q, ctrld_genâ‚Šmachineâ‚ŠX_ls, ctrld_genâ‚Šmachineâ‚ŠTâ€²_d0, ctrld_genâ‚Šmachineâ‚ŠTâ€³_d0, ctrld_genâ‚Šmachineâ‚ŠTâ€²_q0, ctrld_genâ‚Šmachineâ‚ŠTâ€³_q0, ctrld_genâ‚Šmachineâ‚ŠH, ctrld_genâ‚Šmachineâ‚ŠD, ctrld_genâ‚Šmachineâ‚ŠS_b=100, ctrld_genâ‚Šmachineâ‚ŠV_b, ctrld_genâ‚Šmachineâ‚ŠÏ‰_b=376.99, ctrld_genâ‚Šmachineâ‚ŠSn, ctrld_genâ‚Šmachineâ‚ŠVn, ctrld_genâ‚Šavrâ‚ŠTr, ctrld_genâ‚Šavrâ‚Švref<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šavrâ‚ŠKa, ctrld_genâ‚Šavrâ‚ŠKe, ctrld_genâ‚Šavrâ‚ŠKf, ctrld_genâ‚Šavrâ‚ŠTa, ctrld_genâ‚Šavrâ‚ŠTf, ctrld_genâ‚Šavrâ‚ŠTe, ctrld_genâ‚Šavrâ‚Švr_min, ctrld_genâ‚Šavrâ‚Švr_max, ctrld_genâ‚Šavrâ‚ŠE1, ctrld_genâ‚Šavrâ‚ŠE2, ctrld_genâ‚Šavrâ‚ŠSe1, ctrld_genâ‚Šavrâ‚ŠSe2, ctrld_genâ‚Šgovâ‚ŠÏ‰_ref, ctrld_genâ‚Šgovâ‚Šp_ref<span class="sgr90">â‰ˆ1</span>, ctrld_genâ‚Šgovâ‚ŠV_min, ctrld_genâ‚Šgovâ‚ŠV_max, ctrld_genâ‚Šgovâ‚ŠR, ctrld_genâ‚Šgovâ‚ŠT1, ctrld_genâ‚Šgovâ‚ŠT2, ctrld_genâ‚Šgovâ‚ŠT3, ctrld_genâ‚Šgovâ‚ŠDT, ZIPLoadâ‚ŠPset, ZIPLoadâ‚ŠQset, ZIPLoadâ‚ŠVset<span class="sgr90">â‰ˆ1</span>, ZIPLoadâ‚ŠKpZ, ZIPLoadâ‚ŠKqZ, ZIPLoadâ‚ŠKpI, ZIPLoadâ‚ŠKqI, ZIPLoadâ‚ŠKpC, ZIPLoadâ‚ŠKqC]</code></pre><h3 id="Generator-Load-Bus-(Uncontrolled)"><a class="docs-heading-anchor" href="#Generator-Load-Bus-(Uncontrolled)">Generator + Load Bus (Uncontrolled)</a><a id="Generator-Load-Bus-(Uncontrolled)-1"></a><a class="docs-heading-anchor-permalink" href="#Generator-Load-Bus-(Uncontrolled)" title="Permalink"></a></h3><p>Buses with uncontrolled generators and loads</p><pre><code class="nohighlight hljs">            â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
            â•‘ Unctr. Ma. Load Bus (compiled) â•‘
            â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘
  Network   â•‘  â”‚MTKBus      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â•‘
 interface  â•‘  â”‚          â”Œâ”€â”¤ Machine â”‚ â”‚    â•‘
  current â”€â”€â”€â”€â†’â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â•‘
            â•‘  â”‚ â”‚BusBarâ”œâ”€o             â”‚    â•‘
  voltage â†â”€â”€â”€â”€â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”    â”‚    â•‘
            â•‘  â”‚          â””â”€â”¤ Load â”‚    â”‚    â•‘
            â•‘  â”‚            â””â”€â”€â”€â”€â”€â”€â”˜    â”‚    â•‘
            â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘
            â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre><pre><code class="language-julia hljs">@named unctrld_machine_load_bus_template = compile_bus(
    MTKBus(uncontrolled_machine, load);
)
strip_defaults!(unctrld_machine_load_bus_template)
set_default!(unctrld_machine_load_bus_template, r&quot;S_b$&quot;, BASE_MVA)
set_default!(unctrld_machine_load_bus_template, r&quot;Ï‰_b$&quot;, 2Ï€*BASE_FREQ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">VertexModel <span class="sgr1">:unctrld_machine_load_bus_template</span> <span class="sgr94">NoFeedForward()</span>
 â”œâ”€  2 inputs:  [busbarâ‚Ši_r, busbarâ‚Ši_i]
 â”œâ”€  8 states:  [machineâ‚Šterminalâ‚Ši_i<span class="sgr90">â‰ˆ0</span>, machineâ‚Šterminalâ‚Ši_r<span class="sgr90">â‰ˆ0</span>, machineâ‚ŠÏˆâ€³_q<span class="sgr90">â‰ˆ0</span>, machineâ‚ŠÏˆâ€³_d<span class="sgr90">â‰ˆ1</span>, machineâ‚ŠEâ€²_d<span class="sgr90">â‰ˆ1</span>, machineâ‚ŠEâ€²_q<span class="sgr90">â‰ˆ0</span>, machineâ‚ŠÏ‰<span class="sgr90">â‰ˆ1</span>, machineâ‚ŠÎ´<span class="sgr90">â‰ˆ0</span>]
 |     with diagonal mass matrix [0, 0, 1, 1, 1, 1, 1, 1]
 â”œâ”€  2 outputs: [busbarâ‚Šu_r, busbarâ‚Šu_i]
 â””â”€ 30 params:  [machineâ‚Švf_set<span class="sgr90">â‰ˆ1</span>, machineâ‚ŠÏ„_m_set<span class="sgr90">â‰ˆ1</span>, machineâ‚ŠR_s, machineâ‚ŠX_d, machineâ‚ŠX_q, machineâ‚ŠXâ€²_d, machineâ‚ŠXâ€²_q, machineâ‚ŠXâ€³_d, machineâ‚ŠXâ€³_q, machineâ‚ŠX_ls, machineâ‚ŠTâ€²_d0, machineâ‚ŠTâ€³_d0, machineâ‚ŠTâ€²_q0, machineâ‚ŠTâ€³_q0, machineâ‚ŠH, machineâ‚ŠD, machineâ‚ŠS_b=100, machineâ‚ŠV_b, machineâ‚ŠÏ‰_b=376.99, machineâ‚ŠSn, machineâ‚ŠVn, ZIPLoadâ‚ŠPset, ZIPLoadâ‚ŠQset, ZIPLoadâ‚ŠVset<span class="sgr90">â‰ˆ1</span>, ZIPLoadâ‚ŠKpZ, ZIPLoadâ‚ŠKqZ, ZIPLoadâ‚ŠKpI, ZIPLoadâ‚ŠKqI, ZIPLoadâ‚ŠKpC, ZIPLoadâ‚ŠKqC]</code></pre><h2 id="Bus-Instantiation-and-Parameter-Setting"><a class="docs-heading-anchor" href="#Bus-Instantiation-and-Parameter-Setting">Bus Instantiation and Parameter Setting</a><a id="Bus-Instantiation-and-Parameter-Setting-1"></a><a class="docs-heading-anchor-permalink" href="#Bus-Instantiation-and-Parameter-Setting" title="Permalink"></a></h2><p>Now we create the actual bus instances by copying templates and applying specific parameters from the CSV data files.</p><pre><code class="language-julia hljs"># Helper function to apply CSV parameters to bus components
function apply_csv_params!(bus, table, bus_index)
    row_idx = findfirst(table.bus .== bus_index)

    # Apply all parameters except &quot;bus&quot; column
    row = table[row_idx, :]
    for col_name in names(table)
        if col_name != &quot;bus&quot;
            set_default!(bus, Regex(col_name*&quot;\$&quot;), row[col_name])
        end
    end
end</code></pre><p>For each bus in the system, we:</p><ol><li>Select the appropriate template based on its category</li><li>Create a bus instance with the correct vertex index and name</li><li>Apply component-specific parameters from CSV files</li><li>Set the power flow model (PQ, PV, or Slack)</li></ol><pre><code class="language-julia hljs">busses = []
for row in eachrow(bus_df)
    i = row.bus

    # Select template based on bus category
    bus = if row.category == &quot;junction&quot;
        compile_bus(junction_bus_template; vidx=i, name=Symbol(&quot;bus$i&quot;))
    elseif row.category == &quot;load&quot;
        compile_bus(load_bus_template; vidx=i, name=Symbol(&quot;bus$i&quot;))
    elseif row.category == &quot;ctrld_machine&quot;
        compile_bus(ctrld_machine_bus_template; vidx=i, name=Symbol(&quot;bus$i&quot;))
    elseif row.category == &quot;ctrld_machine_load&quot;
        compile_bus(ctrld_machine_load_bus_template; vidx=i, name=Symbol(&quot;bus$i&quot;))
    elseif row.category == &quot;unctrld_machine_load&quot;
        compile_bus(unctrld_machine_load_bus_template; vidx=i, name=Symbol(&quot;bus$i&quot;))
    end

    # Apply component parameters from CSV files
    row.has_load &amp;&amp; apply_csv_params!(bus, load_df, i)
    row.has_gen &amp;&amp; apply_csv_params!(bus, machine_df, i)
    row.has_avr &amp;&amp; apply_csv_params!(bus, avr_df, i)
    row.has_gov &amp;&amp; apply_csv_params!(bus, gov_df, i)

    # Set power flow model based on bus type
    pf_model = if row.bus_type == &quot;PQ&quot;
        pfPQ(P=row.P, Q=row.Q)  ## Load bus: fixed P and Q
    elseif row.bus_type == &quot;PV&quot;
        pfPV(P=row.P, V=row.V)  ## Generator bus: fixed P and V
    elseif row.bus_type == &quot;Slack&quot;
        pfSlack(V=row.V, Î´=0)   ## Slack bus: fixed V and angle
    end
    set_pfmodel!(bus, pf_model)

    push!(busses, bus)
end</code></pre><h2 id="Transmission-Line-Creation"><a class="docs-heading-anchor" href="#Transmission-Line-Creation">Transmission Line Creation</a><a id="Transmission-Line-Creation-1"></a><a class="docs-heading-anchor-permalink" href="#Transmission-Line-Creation" title="Permalink"></a></h2><p>The IEEE 39-bus system includes both transmission lines and transformers, all modeled using the Ï€-line equivalent circuit model.</p><p>The model consists of several layers:</p><ol><li>The <code>PiModel</code>, which satisfies the <a href="../../ModelingConcepts/#Branch-Interface">Branch Interface</a> as it has two terminals</li><li>The <a href="../../API/#PowerDynamics.MTKLine"><code>MTKLine</code></a> constructor, which creates a MTK model fulfilling the <a href="../../ModelingConcepts/#MTKLine-Interface">MTKLine Interface</a></li><li>The compiled <code>EdgeModel</code> created by calling the <a href="../../API/#PowerDynamics.compile_line"><code>compile_line</code></a> constructor</li></ol><pre><code class="nohighlight hljs">       â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
       â•‘ EdgeModel (compiled)             â•‘
   src â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘ dst
vertex â•‘ â”‚MTKLine                       â”‚ â•‘ vertex
   u â”€â”€â”€â†’â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚â†â”€â”€â”€ u
       â•‘ â”‚â”‚LineEndâ”œoâ”¤ PiLine â”œoâ”¤LineEndâ”‚â”‚ â•‘
   i â†â”€â”€â”€â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”€â”€â”€â†’ i
       â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
       â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre><p>(We used the <code>PiLine_fault</code> model since we plan on simulating short circuits later.)</p><pre><code class="language-julia hljs">@named piline_template = compile_line(MTKLine(PiLine_fault(;name=:piline)))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EdgeModel <span class="sgr1">:piline_template</span> <span class="sgr94">PureFeedForward()</span>
 â”œâ”€ 2/2 inputs:  src=[srcâ‚Šu_r, srcâ‚Šu_i] dst=[dstâ‚Šu_r, dstâ‚Šu_i]
 â”œâ”€   0 states:  []  
 â”œâ”€ 2/2 outputs: src=[srcâ‚Ši_r, srcâ‚Ši_i] dst=[dstâ‚Ši_r, dstâ‚Ši_i]
 â””â”€  16 params:  [pilineâ‚ŠR, pilineâ‚ŠX, pilineâ‚ŠG_src, pilineâ‚ŠB_src, pilineâ‚ŠG_dst, pilineâ‚ŠB_dst, pilineâ‚Šr_src=1, pilineâ‚Šr_dst=1, pilineâ‚ŠR_fault=0, pilineâ‚ŠX_fault=0, pilineâ‚ŠG_fault=0, pilineâ‚ŠB_fault=0, pilineâ‚Špos=0.5, pilineâ‚Šactive=1, pilineâ‚Šshortcircuit=0, pilineâ‚Šfaultimp=0]</code></pre><p>Each transmission element is created by:</p><ol><li>Instantiating a line from the template with source and destination buses</li><li>Setting electrical parameters (resistance, reactance, susceptance) from CSV data</li></ol><pre><code class="language-julia hljs">branches = []
for row in eachrow(branch_df)
    # Create line instance with topology
    line = compile_line(piline_template; src=row.src_bus, dst=row.dst_bus)

    # Apply electrical parameters from CSV data
    for col_name in names(branch_df)
        if col_name âˆ‰ [&quot;src_bus&quot;, &quot;dst_bus&quot;, &quot;transformer&quot;]
            set_default!(line, Regex(col_name*&quot;\$&quot;), row[col_name])
        end
    end

    push!(branches, line)
end</code></pre><h2 id="Network-Assembly"><a class="docs-heading-anchor" href="#Network-Assembly">Network Assembly</a><a id="Network-Assembly-1"></a><a class="docs-heading-anchor-permalink" href="#Network-Assembly" title="Permalink"></a></h2><p>Finally, we combine all buses and transmission lines into a complete network model. This creates the IEEE 39-bus test system ready for initialization and simulation.</p><pre><code class="language-julia hljs">nw = Network(busses, branches)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Network with 201 states and 1306 parameters
 â”œâ”€ 39 vertices (5 unique types)
 â””â”€ 46 edges (1 unique type)
Edge-Aggregation using SequentialAggregator(+)</code></pre><p>The network <code>nw</code> now contains the complete IEEE 39-bus model structure. In Part 2 of this tutorial series, we&#39;ll initialize this network by solving the power flow and setting up the dynamic initial conditions.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ieee9bus/">Â« IEEE 9-Bus Example</a><a class="docs-footer-nextpage" href="../ieee39_part2/">IEEE39 Part II: Initialization Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 9 October 2025 08:00">Thursday 9 October 2025</span>. Using Julia version 1.12.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
