<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>IEEE39 Part III: Simulation ¬∑ PowerDynamics.jl</title><meta name="title" content="IEEE39 Part III: Simulation ¬∑ PowerDynamics.jl"/><meta property="og:title" content="IEEE39 Part III: Simulation ¬∑ PowerDynamics.jl"/><meta property="twitter:title" content="IEEE39 Part III: Simulation ¬∑ PowerDynamics.jl"/><meta name="description" content="Documentation for PowerDynamics.jl."/><meta property="og:description" content="Documentation for PowerDynamics.jl."/><meta property="twitter:description" content="Documentation for PowerDynamics.jl."/><meta property="og:url" content="https://juliaenergy.github.io/PowerDynamics.jl/generated/ieee39_part3/"/><meta property="twitter:url" content="https://juliaenergy.github.io/PowerDynamics.jl/generated/ieee39_part3/"/><link rel="canonical" href="https://juliaenergy.github.io/PowerDynamics.jl/generated/ieee39_part3/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PowerDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../ModelingConcepts/">Modeling Concepts</a></li><li><a class="tocitem" href="../../initialization/">Initialization</a></li><li><a class="tocitem" href="../../Library/">Component Library</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../custom_bus/">Custom Generator Bus</a></li><li><a class="tocitem" href="../custom_line/">Custom Transmission Line</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../ieee9bus/">IEEE 9Bus Example</a></li><li><a class="tocitem" href="../ieee39_part1/">IEEE39 Part I: Modeling</a></li><li><a class="tocitem" href="../ieee39_part2/">IEEE39 Part II: Initialization</a></li><li class="is-active"><a class="tocitem" href>IEEE39 Part III: Simulation</a><ul class="internal"><li><a class="tocitem" href="#Short-Circuit-Disturbance-Scenario"><span>Short Circuit Disturbance Scenario</span></a></li><li><a class="tocitem" href="#Network-Initialization"><span>Network Initialization</span></a></li><li><a class="tocitem" href="#Short-Circuit-Disturbance-Definition"><span>Short Circuit Disturbance Definition</span></a></li><li><a class="tocitem" href="#Dynamic-Simulation"><span>Dynamic Simulation</span></a></li><li><a class="tocitem" href="#Results-Analysis"><span>Results Analysis</span></a></li></ul></li><li><a class="tocitem" href="../ieee39_part4/">IEEE39 Part IV: Parameter Tuning</a></li><li><a class="tocitem" href="../emt_toymodel/">EMT Toymodel</a></li></ul></li><li><a class="tocitem" href="../../API/">API</a></li><li><a class="tocitem" href="../../networkdynamics_forward/">üîó NetworkDynamics.jl Docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>IEEE39 Part III: Simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>IEEE39 Part III: Simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaEnergy/PowerDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaEnergy/PowerDynamics.jl/blob/main/docs/examples/ieee39_part3.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ieee39-part3"><a class="docs-heading-anchor" href="#ieee39-part3">IEEE39 Bus Tutorial - Part III: Dynamic Simulation</a><a id="ieee39-part3-1"></a><a class="docs-heading-anchor-permalink" href="#ieee39-part3" title="Permalink"></a></h1><p>This is the third part of the IEEE 39-bus tutorial series:</p><ul><li><strong>Part I: Model Creation</strong> - Build the network structure with buses, lines, and components</li><li><strong>Part II: Initialization</strong> - Perform power flow calculations and dynamic initialization</li><li><strong>Part III: Dynamic Simulation</strong> (this tutorial) - Run time-domain simulations and analyze system behavior</li><li><strong>Part IV: Advanced Modeling &amp; Parameter Optimization</strong> - Create custom components and optimize system parameters</li></ul><p>In this tutorial, we&#39;ll demonstrate how to perform dynamic simulations of power system disturbances using PowerDynamics.jl. We&#39;ll simulate a short circuit fault followed by line disconnection and analyze the system&#39;s dynamic response.</p><h2 id="Short-Circuit-Disturbance-Scenario"><a class="docs-heading-anchor" href="#Short-Circuit-Disturbance-Scenario">Short Circuit Disturbance Scenario</a><a id="Short-Circuit-Disturbance-Scenario-1"></a><a class="docs-heading-anchor-permalink" href="#Short-Circuit-Disturbance-Scenario" title="Permalink"></a></h2><p>We will simulate a three-phase short circuit fault on a transmission line, which is a common and severe disturbance in power systems. The disturbance scenario consists of:</p><ol><li><strong>t = 0.1s</strong>: A short circuit occurs on line 11, drastically reducing its impedance</li><li><strong>t = 0.2s</strong>: The protective relay trips the line, completely disconnecting it from the system</li><li><strong>t = 0.2s onwards</strong>: The system operates with the line permanently out of service</li></ol><p>This scenario tests the system&#39;s ability to:</p><ul><li>Survive the initial fault (maintain synchronism)</li><li>Stabilize after the line disconnection</li><li>Operate reliably with reduced transmission capacity</li></ul><p>This script can be downloaded as a normal Julia script <a href="../ieee39_part3.jl">here</a>.</p><pre><code class="language-julia hljs"># Loading required packages and setup
using PowerDynamics
using PowerDynamics.Library
using ModelingToolkit
using NetworkDynamics
using OrdinaryDiffEqRosenbrock
using OrdinaryDiffEqNonlinearSolve
using CairoMakie

# Load the network model from Part I
EXAMPLEDIR = joinpath(pkgdir(PowerDynamics), &quot;docs&quot;, &quot;examples&quot;)
include(joinpath(EXAMPLEDIR, &quot;ieee39_part1.jl&quot;))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Network with 201 states and 1306 parameters
 ‚îú‚îÄ 39 vertices (5 unique types)
 ‚îî‚îÄ 46 edges (1 unique type)
Edge-Aggregation using SequentialAggregator(+)</code></pre><h2 id="Network-Initialization"><a class="docs-heading-anchor" href="#Network-Initialization">Network Initialization</a><a id="Network-Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Network-Initialization" title="Permalink"></a></h2><p>Before we can run dynamic simulations, we need to initialize the network as described in Part II. This involves solving the power flow and initializing all dynamic components.</p><p>For buses with both generators and loads (buses 31 and 39), we need to add initialization formulas to resolve structural underconstraints by setting the load voltage setpoint equal to the bus voltage magnitude.</p><pre><code class="language-julia hljs"># Add initialization formulas as described in Part II
formula = @initformula :ZIPLoad‚ÇäVset = sqrt(:busbar‚Çäu_r^2 + :busbar‚Çäu_i^2)
set_initformula!(nw[VIndex(31)], formula)
set_initformula!(nw[VIndex(39)], formula)

# Initialize the complete network from power flow solution
s0 = initialize_from_pf!(nw; verbose=false)</code></pre><h2 id="Short-Circuit-Disturbance-Definition"><a class="docs-heading-anchor" href="#Short-Circuit-Disturbance-Definition">Short Circuit Disturbance Definition</a><a id="Short-Circuit-Disturbance-Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Short-Circuit-Disturbance-Definition" title="Permalink"></a></h2><p>To simulate realistic power system dynamics, we need to introduce a disturbance that will excite the system&#39;s dynamic behavior. We&#39;ll simulate a short circuit fault on transmission line 11, which connects buses 5 and 8.</p><h3 id="Understanding-Line-Models-with-Fault-Capability"><a class="docs-heading-anchor" href="#Understanding-Line-Models-with-Fault-Capability">Understanding Line Models with Fault Capability</a><a id="Understanding-Line-Models-with-Fault-Capability-1"></a><a class="docs-heading-anchor-permalink" href="#Understanding-Line-Models-with-Fault-Capability" title="Permalink"></a></h3><p>The transmission line models in our network include built-in parameters for fault simulation:</p><ul><li><code>pibranch‚Çäshortcircuit</code>: When set to 1, this simulates a three-phase to ground short circuit along the line. The position in percentage can be given as a parameter too.</li><li><code>pibranch‚Çäactive</code>: When set to 0, this completely disconnects the line from the network (no current flowing into line or out of line, i.e., the line is disconnected at both ends)</li></ul><h3 id="Callback-Functions-for-Disturbance-Events"><a class="docs-heading-anchor" href="#Callback-Functions-for-Disturbance-Events">Callback Functions for Disturbance Events</a><a id="Callback-Functions-for-Disturbance-Events-1"></a><a class="docs-heading-anchor-permalink" href="#Callback-Functions-for-Disturbance-Events" title="Permalink"></a></h3><p>In order to simulate discrete perturbations, such as enabling a short circuit or disabling a line, we need to use <strong>callbacks</strong>. Callbacks are a neat <a href="https://docs.sciml.ai/DiffEqDocs/stable/features/callback_functions/">feature of DifferentialEquations.jl</a>, which allow you to stop the solver under certain conditions and trigger a user-defined affect function to change the state of the system.</p><p>NetworkDynamics <a href="https://juliadynamics.github.io/NetworkDynamics.jl/stable/callbacks/#Callbacks">inherits this functionality as well</a>. In addition, ND.jl provides a new type of callback: component callbacks. Those are callbacks which are attached to a single component rather than the full network, bringing the effect handling to the component level.</p><p>Here we&#39;ll define two component callbacks: one to enable a short circuit at a given time and one to disable the line at a given time.</p><pre><code class="language-julia hljs"># Select the line to be affected by the short circuit
AFFECTED_LINE = 11</code></pre><p>Let&#39;s examine the transmission line that will experience the short circuit. This line connects two important buses in the network and its outage will test the system&#39;s stability.</p><p>Now we define callback functions to model the disturbance sequence:</p><pre><code class="language-julia hljs"># Define callback to enable short circuit at t=0.1s
_enable_short = ComponentAffect([], [:piline‚Çäshortcircuit]) do u, p, ctx
    @info &quot;Short circuit activated on line $(ctx.src)‚Üí$(ctx.dst) at t = $(ctx.t)s&quot;
    p[:piline‚Çäshortcircuit] = 1
end
shortcircuit_cb = PresetTimeComponentCallback(0.1, _enable_short)

# Define callback to disconnect line at t=0.2s (fault clearing)
_disable_line = ComponentAffect([], [:piline‚Çäactive]) do u, p, ctx
    @info &quot;Line $(ctx.src)‚Üí$(ctx.dst) disconnected at t = $(ctx.t)s&quot;
    p[:piline‚Çäactive] = 0
end
deactivate_cb = PresetTimeComponentCallback(0.2, _disable_line)

# Attach both callbacks to the selected line
set_callback!(nw, EIndex(AFFECTED_LINE), (shortcircuit_cb, deactivate_cb))</code></pre><p>The callbacks are now attached to line 11. During simulation:</p><ol><li>At t=0.1s, the short circuit callback activates, simulating the fault</li><li>At t=0.2s, the line disconnection callback activates, simulating relay action</li></ol><p>Let&#39;s verify the callbacks are properly attached:</p><pre><code class="language-julia hljs">nw[EIndex(AFFECTED_LINE)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EdgeModel <span class="sgr1">:piline_template</span> <span class="sgr94">PureFeedForward()</span> @ Edge 5=&gt;8
 ‚îú‚îÄ 2/2 inputs:    src=[src‚Çäu_r=0.99398, src‚Çäu_i=-0.15054] dst=[dst‚Çäu_r=0.97897, dst‚Çäu_i=-0.18348]
 ‚îú‚îÄ   0 states:    []  
 ‚îú‚îÄ 2/2 outputs:   src=[src‚Çäi_r=-3.033, src‚Çäi_i=1.0503] dst=[dst‚Çäi_r=3.0084, dst‚Çäi_i=-1.1959]
 ‚îú‚îÄ  16 params:    [piline‚ÇäG_src=0, piline‚ÇäB_src=0.0738, piline‚ÇäX_fault=0, piline‚ÇäG_fault=0, piline‚ÇäX=0.0112, piline‚Çäshortcircuit=0, piline‚ÇäB_dst=0.0738, piline‚ÇäG_dst=0, piline‚ÇäB_fault=0, piline‚Çäpos=0.5, piline‚ÇäR_fault=0, piline‚ÇäR=0.0008, piline‚Çär_dst=1, piline‚Çär_src=1, piline‚Çäfaultimp=0, piline‚Çäactive=1]
 ‚îî‚îÄ   2 callbacks: (:piline‚Çäshortcircuit) affected at t=0.1
                   (:piline‚Çäactive) affected at t=0.2</code></pre><h2 id="Dynamic-Simulation"><a class="docs-heading-anchor" href="#Dynamic-Simulation">Dynamic Simulation</a><a id="Dynamic-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Dynamic-Simulation" title="Permalink"></a></h2><p>Now we&#39;re ready to perform the dynamic simulation. We&#39;ll set up and solve an ordinary differential equation (ODE) problem that represents the network&#39;s dynamic behavior.</p><h3 id="Simulation-Setup"><a class="docs-heading-anchor" href="#Simulation-Setup">Simulation Setup</a><a id="Simulation-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Setup" title="Permalink"></a></h3><p>The simulation process involves:</p><ol><li>Creating the initial state vector from our initialized network</li><li>Setting up the ODE problem with appropriate time span and callbacks</li><li>Solving the ODE using a suitable numerical method</li><li>Analyzing the results</li></ol><p>Note that we use <a href="https://juliadynamics.github.io/NetworkDynamics.jl/stable/API/#NetworkDynamics.get_callbacks-Tuple%7BNetwork%7D"><code>get_callbacks</code></a> to collect the component callbacks, transform them into a <code>CallbackSet</code> compatible with the DifferentialEquations.jl ecosystem and pass them to the ODEProblem.</p><pre><code class="language-julia hljs">u0 = NWState(nw) # state is stored in metadata because of mutating init function!
prob = ODEProblem(nw, uflat(u0), (0.0, 15.0), copy(pflat(u0)); callback=get_callbacks(nw))
# Solve the ODE using Rodas5P (suitable for stiff differential-algebraic systems)
sol = solve(prob, Rodas5P());
@assert SciMLBase.successful_retcode(sol) # ensure the simulation was successful</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Short circuit activated on line 5‚Üí8 at t = 0.1s
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Line 5‚Üí8 disconnected at t = 0.2s</code></pre><p>The simulation is complete! The <code>sol</code> object contains the time-domain solution of all network variables. We can now analyze how the system responded to the short circuit disturbance.</p><div class="admonition is-success" id="Tip-9789e66a4dbb91f9"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-9789e66a4dbb91f9" title="Permalink"></a></header><div class="admonition-body"><p>The ODEProblem contains a reference to exactly one copy of the <em>flat parameter array</em>. If you use callbacks to change those parameters (as we do), it is advised to <code>copy</code> the parameter array before passing it to the ODEProblem! Otherwise the callback will change our <code>u0</code> object. Also, this means you need to be careful when using the same <code>prob</code> for multiple subsequent <code>solve</code> calls, as the initial state of the <code>prob</code> object might have changed!</p></div></div><h3 id="Simulation-Results-Overview"><a class="docs-heading-anchor" href="#Simulation-Results-Overview">Simulation Results Overview</a><a id="Simulation-Results-Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Results-Overview" title="Permalink"></a></h3><p>The solution object contains:</p><ul><li>Time-domain trajectories of all state variables (generator angles, voltages, etc.)</li><li>Network interface variables (bus voltages, line currents and power flows)</li><li>Full system response from t=0 to t=15 seconds</li></ul><p>Let&#39;s examine some key aspects of the system response through various plots.</p><h2 id="Results-Analysis"><a class="docs-heading-anchor" href="#Results-Analysis">Results Analysis</a><a id="Results-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Results-Analysis" title="Permalink"></a></h2><h3 id="Power-Flow-in-the-Affected-Line"><a class="docs-heading-anchor" href="#Power-Flow-in-the-Affected-Line">Power Flow in the Affected Line</a><a id="Power-Flow-in-the-Affected-Line-1"></a><a class="docs-heading-anchor-permalink" href="#Power-Flow-in-the-Affected-Line" title="Permalink"></a></h3><p>First, let&#39;s examine how the power flow through the faulted line changes during the disturbance. This plot shows the most direct impact of our short circuit and line disconnection events.</p><pre><code class="language-julia hljs">let fig = Figure(; size=(800, 400))
    ax = Axis(fig[1, 1];
        title=&quot;Active Power Flow in Line $AFFECTED_LINE During Short Circuit&quot;,
        xlabel=&quot;Time [s]&quot;,
        ylabel=&quot;Active Power [pu]&quot;)

    # Focus on the disturbance period to see the fault clearly
    ts = range(0, 0.35, length=1000)

    # Plot power flow at the destination end of the line
    lines!(ax, ts, sol(ts; idxs=EIndex(AFFECTED_LINE, :src‚ÇäP)).u;
           label=&quot;Active Power towards src&quot;, linewidth=2)
    lines!(ax, ts, sol(ts; idxs=EIndex(AFFECTED_LINE, :dst‚ÇäP)).u;
           label=&quot;Active Power towards dst&quot;, linewidth=2)

    axislegend(ax; position=:rt)

    fig
end</code></pre><img src="b0e14f45.png" alt="Example block output"/><p><strong>Observations:</strong></p><ul><li><strong>Normal operation (t &lt; 0.1s)</strong>: Steady power flow through the line. Power towards destination is positive while power towards source is negative. This means we have net transmission from bus 5 to bus 8.</li><li><strong>Short circuit (0.1s &lt; t &lt; 0.2s)</strong>: Dramatic power flow change due to the short circuit. Both source and destination show negative power, which means we have active power flowing from both sides towards the short circuit.</li><li><strong>Line disconnection (t &gt; 0.2s)</strong>: Zero power flow as the line is permanently out of service</li></ul><p>The power absorption during the fault demonstrates the severe electrical stress that short circuits place on the system. The protective relay action at t=0.2s successfully isolates the fault.</p><h3 id="Voltage-Response-at-Adjacent-Buses"><a class="docs-heading-anchor" href="#Voltage-Response-at-Adjacent-Buses">Voltage Response at Adjacent Buses</a><a id="Voltage-Response-at-Adjacent-Buses-1"></a><a class="docs-heading-anchor-permalink" href="#Voltage-Response-at-Adjacent-Buses" title="Permalink"></a></h3><p>Next, let&#39;s examine how the buses directly connected to the faulted line respond to the disturbance. These buses experience the most severe voltage impacts during the fault.</p><pre><code class="language-julia hljs">let fig = Figure(; size=(800, 500))
    ax = Axis(fig[1, 1];
        title=&quot;Voltage Magnitudes at Buses Adjacent to Faulted Line&quot;,
        xlabel=&quot;Time [s]&quot;,
        ylabel=&quot;Voltage Magnitude [pu]&quot;)

    # Full simulation time to see both disturbance and recovery
    ts = range(0, 15, length=1000)

    # Get the source and destination buses of the affected line
    src_bus, dst_bus = get_graphelement(nw[EIndex(AFFECTED_LINE)])

    # Plot voltage magnitudes at both ends of the faulted line
    lines!(ax, ts, sol(ts; idxs=VIndex(src_bus, :busbar‚Çäu_mag)).u;
           label=&quot;Bus $src_bus (source)&quot;, linewidth=2)
    lines!(ax, ts, sol(ts; idxs=VIndex(dst_bus, :busbar‚Çäu_mag)).u;
           label=&quot;Bus $dst_bus (destination)&quot;, linewidth=2)

    axislegend(ax; position=:rb)
    ylims!(ax, 0.85, 1.15)

    fig
end</code></pre><img src="8c68d3b6.png" alt="Example block output"/><p><strong>Observations:</strong> Both buses experience voltage depression during the short circuit but are able to recover after the short circuit is cleared by disconnection of the line.</p><p>The voltage recovery demonstrates the system&#39;s ability to adapt to the new network topology after the line outage. The generators&#39; automatic voltage regulators help maintain voltage stability.</p><h3 id="System-Wide-Voltage-Response"><a class="docs-heading-anchor" href="#System-Wide-Voltage-Response">System-Wide Voltage Response</a><a id="System-Wide-Voltage-Response-1"></a><a class="docs-heading-anchor-permalink" href="#System-Wide-Voltage-Response" title="Permalink"></a></h3><p>To get a complete picture of the system&#39;s response, let&#39;s examine the voltage profiles across all 39 buses. This &quot;spaghetti plot&quot; shows how the disturbance propagates through the entire network.</p><pre><code class="language-julia hljs">let fig = Figure(; size=(800, 600))
    ax = Axis(fig[1, 1];
        title=&quot;Voltage Magnitudes Across All 39 Buses&quot;,
        xlabel=&quot;Time [s]&quot;,
        ylabel=&quot;Voltage Magnitude [pu]&quot;)

    # Full simulation time range
    ts = range(0, 15, length=1000)

    # Plot voltage magnitude for all buses
    for i in 1:39
        voltage_data = sol(ts; idxs=VIndex(i, :busbar‚Çäu_mag)).u
        lines!(ax, ts, voltage_data; linewidth=2)
    end
    ylims!(ax, 0.85, 1.15)
    fig
end</code></pre><img src="73c4d2d1.png" alt="Example block output"/><p>Once again, we see how all bus voltages are affected by the short circuit and the overall voltage drops. However, after the fault is cleared, the system achieves a synchronous steady-state again.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ieee39_part2/">¬´ IEEE39 Part II: Initialization</a><a class="docs-footer-nextpage" href="../ieee39_part4/">IEEE39 Part IV: Parameter Tuning ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 9 August 2025 10:13">Saturday 9 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
